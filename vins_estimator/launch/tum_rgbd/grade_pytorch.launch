<launch>
    <arg name="config" default="" />
    <arg name="config_path" default="$(find vins_estimator)/../config/tum_rgbd/$(arg config)"/>
    <arg name="vins_path" default="$(find vins_estimator)/../config/../" />
    <arg name="exp" default="75bf6" />
    <arg name="path" default="/home/cxu/GRADE_bags" />
    <arg name="bag_path" default="$(arg path)/$(arg exp)" />

    <arg name="rgb" default="/my_robot_0/camera_link/1/rgb/image_raw" unless="$(eval arg('exp') == 'S' or arg('exp') == 'SH')"/>
    <arg name="depth" default="/my_robot_0/camera_link/1/depth/image_raw"  unless="$(eval arg('exp') == 'S' or arg('exp') == 'SH')"/>
    <arg name="rgb" default="/my_robot_0/camera_link/0/rgb/image_raw" if="$(eval arg('exp') == 'SH' or arg('exp') == 'S')"/>
    <arg name="depth" default="/my_robot_0/camera_link/0/depth/image_raw" if="$(eval arg('exp') == 'S' or arg('exp') == 'SH')"/>
    <remap from="/rgb" to="$(arg rgb)" />
    <remap from="/depth" to="$(arg depth)" />
    <remap from="/camera/color/image_raw" to="$(arg rgb)" />

    <include file="$(find yolo_ros)/launch/yolo_service.launch">
    </include>

    <arg name="manager_name" default="nodelet_manager_pc" />
    <node pkg="nodelet" type="nodelet" name="$(arg manager_name)" args="manager" output="log" />

    <node pkg="nodelet" type="nodelet" name="EstimatorNodelet" args="load vins_estimator/EstimatorNodelet $(arg manager_name)" output="log">
        <param name="config_file" type="string" value="$(arg config_path)" />
        <param name="vins_folder" type="string" value="$(arg vins_path)" />
    </node>

    <node pkg="nodelet" type="nodelet" name="PoseGraphNodelet" args="load pose_graph/PoseGraphNodelet $(arg manager_name)" output="log">
        <param name="config_file" type="string" value="$(arg config_path)"/>
        <param name="visualization_shift_x" type="int" value="0"/>
        <param name="visualization_shift_y" type="int" value="0"/>
        <param name="skip_cnt" type="int" value="0"/>
        <param name="skip_dis" type="double" value="0"/>
    </node>

    <node pkg="rosbag" type="record" name="my_rosbag" args="-o $(arg exp)   /my_robot_0/camera/pose 
                                                                            /my_robot_0/odom 
                                                                            /vins_estimator/camera_pose
                                                                            /vins_estimator/init_map_time"/> 

    <node pkg="rosbag" type="play" name="play_bag" args="-d 20 -r 0.2 --clock  $(arg bag_path)/$(arg exp)_0.bag
                                                                        $(arg bag_path)/$(arg exp)_1.bag
                                                                        $(arg bag_path)/$(arg exp)_2.bag
                                                                        $(arg bag_path)/$(arg exp)_3.bag
                                                                        $(arg bag_path)/$(arg exp)_4.bag
                                                                        $(arg bag_path)/$(arg exp)_5.bag
                                                                        $(arg bag_path)/$(arg exp)_6.bag
                                                                        $(arg bag_path)/$(arg exp)_7.bag
                                                                        $(arg bag_path)/$(arg exp)_8.bag
                                                                        $(arg bag_path)/$(arg exp)_9.bag"/>
</launch>
